<% if user_signed_in? && @listing.store.user_id == current_user.id %>
  
  <%= render 'shared/page_title', title: "Product listing" %>
  
  <div class="container">
    
    <div align="center">
      <h3 class="underline"><%= @listing.title %></h3>
    </div>
    
    
    <br />
    
    <% if @listing.product_image %>
      <div class="row">
        <div class="col-md-4 offset-md-4 center">
          <%= image_tag @listing.product_image_url(:thumb) %>
        </div>
      </div>
    <% else %>
      <div align="center">
        <p> You have not selected an image for this product. <%= link_to "Click here to add one.", edit_listing_path(@listing) %>
      </div>
    <% end %>
    
    <br />
    
    <div class="row col-md-12">
      <div class="col-md-2 offset-md-3">
        <%= link_to 'Edit product', edit_listing_path(@listing), class: "btn btn-primary btn-lg btn-xlarge" %>
      </div>
      
      <div class="col-md-2 offset-md-2">
        <%= link_to 'My store', store_path(@listing.store), class: "btn btn-primary btn-lg btn-xlarge" %>
      </div>
    </div>
    
    <br />
    
    <table align="center">
      <thead>
        <tr>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        
        <tr>
          <td><strong>Variety</strong></td>
          <td><%= @listing.variety %></td>        
        </tr>
        
        <tr>
          <td><strong>Origin</strong></td>
          <td><%= @listing.country_name %></td>        
        </tr>
        
        <% if @listing.region %>
          <tr>
            <td><strong>Region</strong></td>
            <td><%= @listing.region %></td>        
          </tr>
        <% end %>
        
        <% if @listing.producer %>
          <tr>
            <td><strong>Producer</strong></td>
            <td><%= @listing.producer %></td>        
          </tr>
        <% end %>
        
        <% if @listing.notes %>
          <tr>
            <td><strong>Notes</strong></td>
            <td><%= @listing.notes %></td>        
          </tr>
        <% end %>
        
        <tr>
          <td><strong>Weight</strong></td>
          <td><%= @listing.weight %> grams</td>        
        </tr>
        
        <tr>
          <td><strong>Date roasted</strong></td>
          <td><%= @listing.roast_date %></td>        
        </tr>
        
        <tr>
          <td><strong>About:</strong></td>
          <td></td>
        </tr>
        <tr>
          <td colspan="2"><%= @listing.about %></td>        
        </tr>
        
        <tr>
          <td><strong>Price</strong></td>
          <td>$<%= @listing.price %></td>        
        </tr>
        
        <tr>
          <td><strong>Shipping</strong></td>
          <td>$<%= @listing.shipping %></td>        
        </tr>
        
        <tr>
          <td><strong>Total Price</strong></td>
          <td>$<%= @total_price %></td>        
        </tr>
        
      </tbody>
    </table>

    <br />
    
    <div align="center">
      <%= button_to "Delete product", listings_path(@listing), class: "btn btn-danger btn-lg", data: { confirm: "Are you sure?" }, method: :delete %>
    </div>

  </div>
  
<% else %>

  <%= render 'shared/page_title', title: "#{@listing.title}" %>
  
  <div class="container">
  
    <br />
    
    <% if @listing.product_image %>
      <div class="row">
        <div class="col-md-4 offset-md-4 center">
          <%= image_tag @listing.product_image_url(:thumb) %>
        </div>
      </div>
    <% end %>
    
    <br />

    <table align="center">
      <thead>
        <tr>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        
        <tr>
          <td><strong>Variety</strong></td>
          <td><%= @listing.variety %></td>        
        </tr>
        
        <tr>
          <td><strong>Origin</strong></td>
          <td><%= @listing.country_name %></td>        
        </tr>
        
        <% if @listing.region %>
          <tr>
            <td><strong>Region</strong></td>
            <td><%= @listing.region %></td>        
          </tr>
        <% end %>
        
        <% if @listing.producer %>
          <tr>
            <td><strong>Producer</strong></td>
            <td><%= @listing.producer %></td>        
          </tr>
        <% end %>
        
        <% if @listing.notes %>
          <tr>
            <td><strong>Notes</strong></td>
            <td><%= @listing.notes %></td>        
          </tr>
        <% end %>
        
        <tr>
          <td><strong>Weight</strong></td>
          <td><%= @listing.weight %> grams</td>        
        </tr>
        
        <tr>
          <td><strong>Date roasted</strong></td>
          <td><%= @listing.roast_date %></td>        
        </tr>
        
        <tr>
          <td><strong>About:</strong></td>
          <td></td>
        </tr>
        <tr>
          <td colspan="2"><%= @listing.about %></td>        
        </tr>
        
        <tr>
          <td><strong>Price</strong></td>
          <td>$<%= @listing.price %></td>        
        </tr>
        
        <tr>
          <td><strong>Shipping</strong></td>
          <td>$<%= @listing.shipping %></td>        
        </tr>
        
        <tr>
          <td><strong>Total Price</strong></td>
          <td>$<%= @total_price %></td>        
        </tr>
        
      </tbody>
    </table>    
    <br />
    
    <% if user_signed_in? %>
      <div align="center">
        <%= link_to 'Buy Now', root_path, class: "btn btn-primary btn-lg btn-xlarge" %>
      </div>
      
      <br />
      
      <div align="center">
        <%= link_to 'Message', root_path, class: "btn btn-primary btn-md" %>
      </div>
      
      <br />
      
      <div align="center">
        <%= link_to 'View store', store_path(@listing.store), class: "btn btn-primary btn-md" %>
      </div>
    
    <% else %>
    
      <div align="center">
        <%= link_to 'Sign in to buy!', new_user_session_path, class: "btn btn-primary btn-lg" %>
      </div>
    
    <% end %>

  </div>
<% end %>